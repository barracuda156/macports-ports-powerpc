From 3e41d9f96573d2bae05fc126f83a4096cf154eaa Mon Sep 17 00:00:00 2001
From: Sergey Fedorov <vital.had@gmail.com>
Date: Fri, 26 Jul 2024 03:38:45 +0800
Subject: [PATCH 1/2] t # This is a combination of 2 commits.

cfstring: fix
---
 include/wx/osx/core/cfstring.h | 7 +++----
 src/osx/core/cfstring.cpp      | 6 +++---
 2 files changed, 6 insertions(+), 7 deletions(-)

diff --git include/wx/osx/core/cfstring.h include/wx/osx/core/cfstring.h
index 6468713139..deea6d855a 100644
--- include/wx/osx/core/cfstring.h
+++ include/wx/osx/core/cfstring.h
@@ -66,11 +66,10 @@ public:
 
     static wxString AsString( CFStringRef ref, wxFontEncoding encoding = wxFONTENCODING_DEFAULT ) ;
     static wxString AsStringWithNormalizationFormC( CFStringRef ref, wxFontEncoding encoding = wxFONTENCODING_DEFAULT ) ;
-#ifdef __WXMAC__
+#ifdef __OBJC__
     static wxString AsString( WX_NSString ref, wxFontEncoding encoding = wxFONTENCODING_DEFAULT ) ;
     static wxString AsStringWithNormalizationFormC( WX_NSString ref, wxFontEncoding encoding = wxFONTENCODING_DEFAULT ) ;
-#endif
-#ifdef __OBJC__
+
     WX_NSString AsNSString() const { return (WX_OSX_BRIDGE WX_NSString)(CFStringRef) *this; }
 #endif
 private:
@@ -87,7 +86,7 @@ inline wxCFStringRef wxCFStringRefFromGet(CFStringRef p)
     return wxCFStringRef(wxCFRetain(p));
 }
 
-#ifdef __WXMAC__
+#ifdef __OBJC__
 /*! @function   wxCFStringRefFromGet
     @abstract   Factory function to create wxCFStringRefRef from a NSString* obtained from a Get-rule function
     @param  p           The NSString pointer to retain and create a wxCFStringRefRef from.  May be NULL.
diff --git src/osx/core/cfstring.cpp src/osx/core/cfstring.cpp
index 977b316282..893d08bc8e 100644
--- src/osx/core/cfstring.cpp
+++ src/osx/core/cfstring.cpp
@@ -688,14 +688,14 @@ wxString wxCFStringRef::AsString(wxFontEncoding encoding) const
     return AsString( get(), encoding );
 }
 
-#ifdef __WXMAC__
+#ifdef __APPLE__
 
-wxString wxCFStringRef::AsString( NSString* ref, wxFontEncoding encoding )
+inline wxString wxCFStringRef::AsString( NSString* ref, wxFontEncoding encoding )
 {
     return AsString( (CFStringRef) ref, encoding );
 }
 
-wxString wxCFStringRef::AsStringWithNormalizationFormC( NSString* ref, wxFontEncoding encoding )
+inline wxString wxCFStringRef::AsStringWithNormalizationFormC( NSString* ref, wxFontEncoding encoding )
 {
     return AsStringWithNormalizationFormC( (CFStringRef) ref, encoding );
 }
-- 
2.45.2

