From 5631089161a21769ad38d09f16a7d324cc90776e Mon Sep 17 00:00:00 2001
From: Sergey Fedorov <vital.had@gmail.com>
Date: Mon, 22 Jul 2024 18:24:14 +0800
Subject: [PATCH 2/4] Fix cfstring for macOS

---
 include/wx/osx/core/cfstring.h | 18 +++++++++++++++---
 src/osx/core/cfstring.cpp      | 14 --------------
 2 files changed, 15 insertions(+), 17 deletions(-)

diff --git include/wx/osx/core/cfstring.h include/wx/osx/core/cfstring.h
index e1a557fde8..a568e2fe20 100644
--- include/wx/osx/core/cfstring.h
+++ include/wx/osx/core/cfstring.h
@@ -66,16 +66,28 @@
 
     static wxString AsString( CFStringRef ref, wxFontEncoding encoding = wxFONTENCODING_DEFAULT ) ;
     static wxString AsStringWithNormalizationFormC( CFStringRef ref, wxFontEncoding encoding = wxFONTENCODING_DEFAULT ) ;
-#ifdef __WXMAC__
+
+#ifdef __OBJC__
     static wxString AsString( WX_NSString ref, wxFontEncoding encoding = wxFONTENCODING_DEFAULT ) ;
     static wxString AsStringWithNormalizationFormC( WX_NSString ref, wxFontEncoding encoding = wxFONTENCODING_DEFAULT ) ;
-#endif
-#ifdef __OBJC__
+
     WX_NSString AsNSString() const { return (WX_OSX_BRIDGE WX_NSString)(CFStringRef) *this; }
 #endif
 private:
 } ;
 
+#ifdef __OBJC__
+    inline wxString wxCFStringRef::AsString( NSString* ref )
+    {
+        return AsString( (CFStringRef) ref );
+    }
+
+    inline wxString wxCFStringRef::AsStringWithNormalizationFormC( NSString* ref )
+    {
+        return AsStringWithNormalizationFormC( (CFStringRef) ref );
+    }
+#endif
+
 /*! @function   wxCFStringRefFromGet
     @abstract   Factory function to create wxCFStringRefRef from a CFStringRef obtained from a Get-rule function
     @param  p           The CFStringRef to retain and create a wxCFStringRefRef from.  May be NULL.
diff --git src/osx/core/cfstring.cpp src/osx/core/cfstring.cpp
index a692dbead1..3430607349 100644
--- src/osx/core/cfstring.cpp
+++ src/osx/core/cfstring.cpp
@@ -686,18 +686,4 @@
 wxString wxCFStringRef::AsString(wxFontEncoding encoding) const
 {
     return AsString( get(), encoding );
-}
-
-#ifdef __WXMAC__
-
-wxString wxCFStringRef::AsString( NSString* ref, wxFontEncoding encoding )
-{
-    return AsString( (CFStringRef) ref, encoding );
-}
-
-wxString wxCFStringRef::AsStringWithNormalizationFormC( NSString* ref, wxFontEncoding encoding )
-{
-    return AsStringWithNormalizationFormC( (CFStringRef) ref, encoding );
 }
-
-#endif
